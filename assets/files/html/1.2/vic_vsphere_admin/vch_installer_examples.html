
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Advanced Examples of Deploying a VCH Â· VMware vSphere Integrated Containers 1.2 Documentation</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.2">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-expandable-chapters/expandable-chapters.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="deploy_vch_registry.html" />
    
    
    <link rel="prev" href="vic_env_variables.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        <li class="header">vSphere Integrated Containers 1.2</li>
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1.1" data-path="../vic_quickstart.html">
            
                <a href="../vic_quickstart.html">
            
                    
                    Quick Start Links
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.1.2" data-path="../vic_overview/introduction.html">
            
                <a href="../vic_overview/introduction.html">
            
                    
                    Overview
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="./">
            
                <a href="./">
            
                    
                    Install, Deploy, Maintain Infrastructure
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.1" data-path="installing_vic.html">
            
                <a href="installing_vic.html">
            
                    
                    Installation
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.1.1" data-path="download_vic.html">
            
                <a href="download_vic.html">
            
                    
                    Download
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.1.2" data-path="deploy_vic_appliance.html">
            
                <a href="deploy_vic_appliance.html">
            
                    
                    Deploy the Appliance
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.1.3" data-path="install_vic_plugin.html">
            
                <a href="install_vic_plugin.html">
            
                    
                    Installing the Plug-ins
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.1.3.1" data-path="plugins_vc_windows.html">
            
                <a href="plugins_vc_windows.html">
            
                    
                    vCenter Server for Windows
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.1.3.2" data-path="plugins_vcsa.html">
            
                <a href="plugins_vcsa.html">
            
                    
                    vCenter Server Appliance
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.1.1.4" data-path="open_ports_on_hosts.html">
            
                <a href="open_ports_on_hosts.html">
            
                    
                    Open the Required Ports on ESXi Hosts
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.1.2" data-path="networks.html">
            
                <a href="networks.html">
            
                    
                    VCH Networking
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3" data-path="deploy_demo_vch.html">
            
                <a href="deploy_demo_vch.html">
            
                    
                    Deploy VCHs Interactively
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.4" data-path="deploy_vch.html">
            
                <a href="deploy_vch.html">
            
                    
                    Deploy VCHs with vic-machine
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.4.1" data-path="contents_of_vic_binaries.html">
            
                <a href="contents_of_vic_binaries.html">
            
                    
                    Contents of the vSphere Integrated Containers Engine Binaries
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.4.2" data-path="vic_installation_prereqs.html">
            
                <a href="vic_installation_prereqs.html">
            
                    
                    Environment Prerequisites for VCH Deployment
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.4.3" data-path="obtain_thumbprint.html">
            
                <a href="obtain_thumbprint.html">
            
                    
                    Obtain Certificate Thumbprints
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.4.4" data-path="deploy_vch_esxi.html">
            
                <a href="deploy_vch_esxi.html">
            
                    
                    Deploy a VCH to an ESXi Host with No vCenter Server
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.4.5" data-path="deploy_vch_vcenter.html">
            
                <a href="deploy_vch_vcenter.html">
            
                    
                    Deploy a VCH to a Basic vCenter Server Cluster
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.4.6" data-path="verify_vch_deployment.html">
            
                <a href="verify_vch_deployment.html">
            
                    
                    Verify the Deployment of a VCH
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.4.7" data-path="vch_installer_options.html">
            
                <a href="vch_installer_options.html">
            
                    
                    VCH Deployment Options
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.4.8" data-path="vic_env_variables.html">
            
                <a href="vic_env_variables.html">
            
                    
                    Set Environment Variables
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="2.1.4.9" data-path="vch_installer_examples.html">
            
                <a href="vch_installer_examples.html">
            
                    
                    Advanced Examples of Deploying a VCH
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.4.10" data-path="deploy_vch_registry.html">
            
                <a href="deploy_vch_registry.html">
            
                    
                    Deploy a VCH for Use with vSphere Integrated Containers Registry
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.4.11" data-path="set_up_ops_user.html">
            
                <a href="set_up_ops_user.html">
            
                    
                    Use Different User Accounts for VCH Deployment and Operation
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.1.5" data-path="vch_admin.html">
            
                <a href="vch_admin.html">
            
                    
                    VCH Administration
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.5.1" data-path="interop.html">
            
                <a href="interop.html">
            
                    
                    Interoperability
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.5.2" data-path="vch_admin_client.html">
            
                <a href="vch_admin_client.html">
            
                    
                    VCH Admin in the vSphere Client
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.5.2.1" data-path="access_h5_ui.html">
            
                <a href="access_h5_ui.html">
            
                    
                    View All VCH and Container Information
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.5.2.2" data-path="vch_portlet_ui.html">
            
                <a href="vch_portlet_ui.html">
            
                    
                    View Individual VCH and Container Information
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.1.5.3" data-path="vch_admin_vicmachine.html">
            
                <a href="vch_admin_vicmachine.html">
            
                    
                    VCH Admin with vic-machine
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.5.3.1" data-path="vic_machine_version.html">
            
                <a href="vic_machine_version.html">
            
                    
                    Obtain Version Information
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.5.3.2" data-path="common_vic_options.html">
            
                <a href="common_vic_options.html">
            
                    
                    Common Options
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.5.3.3" data-path="list_vch.html">
            
                <a href="list_vch.html">
            
                    
                    List VCHs
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.5.3.4" data-path="inspect_vch.html">
            
                <a href="inspect_vch.html">
            
                    
                    Obtain General VCH Information and Connection Details
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.5.3.5" data-path="inspect_vch_config.html">
            
                <a href="inspect_vch_config.html">
            
                    
                    Obtain VCH Configuration Information
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.5.3.6" data-path="configure_vch.html">
            
                <a href="configure_vch.html">
            
                    
                    Configure VCHs
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.5.3.7" data-path="remove_vch.html">
            
                <a href="remove_vch.html">
            
                    
                    Delete VCHs
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.5.3.8" data-path="debug_vch.html">
            
                <a href="debug_vch.html">
            
                    
                    Debug VCHs
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.5.3.8.1" data-path="vch_shell_access.html">
            
                <a href="vch_shell_access.html">
            
                    
                    Enable Shell Access
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.5.3.8.2" data-path="vch_ssh_access.html">
            
                <a href="vch_ssh_access.html">
            
                    
                    Authorize SSH Access
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.1.5.4" data-path="access_vicadmin.html">
            
                <a href="access_vicadmin.html">
            
                    
                    VCH Admin Portal
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.5.4.1" data-path="browser_login.html">
            
                <a href="browser_login.html">
            
                    
                    Browser-Based Certificate Login
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.5.4.2" data-path="cmdline_login.html">
            
                <a href="cmdline_login.html">
            
                    
                    Command Line Certificate Login
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.5.4.3" data-path="vicadmin_status_ref.html">
            
                <a href="vicadmin_status_ref.html">
            
                    
                    VCH Admin Status Reference
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.1.6" data-path="upgrading_vic.html">
            
                <a href="upgrading_vic.html">
            
                    
                    Upgrading
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.6.1" data-path="upgrade_data.html">
            
                <a href="upgrade_data.html">
            
                    
                    Data Migration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.6.2" data-path="pre_upgrade_tasks.html">
            
                <a href="pre_upgrade_tasks.html">
            
                    
                    Pre-Upgrade Tasks
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.6.3" data-path="upgrade_appliance.html">
            
                <a href="upgrade_appliance.html">
            
                    
                    Upgrade the Appliance
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.6.4" data-path="upgrade_vch.html">
            
                <a href="upgrade_vch.html">
            
                    
                    Upgrade VCHs
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.6.4.1" data-path="upgrade_vch_options.html">
            
                <a href="upgrade_vch_options.html">
            
                    
                    VCH Upgrade Options
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.1.6.5" data-path="upgrade_h5_plugin_windows.html">
            
                <a href="upgrade_h5_plugin_windows.html">
            
                    
                    Upgrade Plug-In on Windows
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.6.6" data-path="upgrade_h5_plugin_vcsa.html">
            
                <a href="upgrade_h5_plugin_vcsa.html">
            
                    
                    Upgrade Plug-In VCSA
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.1.7" data-path="manage_appliance.html">
            
                <a href="manage_appliance.html">
            
                    
                    Managing the Appliance
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.7.1" data-path="reconfigure_appliance.html">
            
                <a href="reconfigure_appliance.html">
            
                    
                    Reconfigure the Appliance
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.7.2" data-path="service_status.html">
            
                <a href="service_status.html">
            
                    
                    Check Service Status
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.7.3" data-path="restart_services.html">
            
                <a href="restart_services.html">
            
                    
                    Restart Services
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.1.8" data-path="troubleshoot_vic.html">
            
                <a href="troubleshoot_vic.html">
            
                    
                    Troubleshooting
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.8.1" data-path="log_bundles.html">
            
                <a href="log_bundles.html">
            
                    
                    Access Log Bundles
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.8.2" data-path="ts_vch_deployment_timeout.html">
            
                <a href="ts_vch_deployment_timeout.html">
            
                    
                    VCH Deployment Times Out
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.8.3" data-path="ts_thumbprint_error.html">
            
                <a href="ts_thumbprint_error.html">
            
                    
                    Certificate Verification Error
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.8.4" data-path="ts_cli_argument_error.html">
            
                <a href="ts_cli_argument_error.html">
            
                    
                    Missing Common Name Error Even When TLS Options Are Specified Correctly
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.8.5" data-path="ts_firewall_error.html">
            
                <a href="ts_firewall_error.html">
            
                    
                    Firewall Validation Error
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.8.6" data-path="ts_cname_mismatch.html">
            
                <a href="ts_cname_mismatch.html">
            
                    
                    Certificate cname Mismatch
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.8.7" data-path="ts_docker_api_check_error.html">
            
                <a href="ts_docker_api_check_error.html">
            
                    
                    Docker API Endpoint Check Failed Error
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.8.8" data-path="ts_datastore_access_error.html">
            
                <a href="ts_datastore_access_error.html">
            
                    
                    No Single Host Can Access All Datastores
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.8.9" data-path="ts_plugin_script_fails.html">
            
                <a href="ts_plugin_script_fails.html">
            
                    
                    Plug-In Scripts Fail
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.8.10" data-path="ts_ui_not_appearing.html">
            
                <a href="ts_ui_not_appearing.html">
            
                    
                    Plug-In Does Not Appear
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.8.11" data-path="ts_delete_inspect_error.html">
            
                <a href="ts_delete_inspect_error.html">
            
                    
                    Deleting or Inspecting a VCH Fails
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.8.12" data-path="ts_clock_skew.html">
            
                <a href="ts_clock_skew.html">
            
                    
                    Certificate Errors when Using Full TLS Authentication with Trusted Certificates
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.1.9" data-path="security_reference.html">
            
                <a href="security_reference.html">
            
                    
                    Security Reference
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="../vic_cloud_admin/">
            
                <a href="../vic_cloud_admin/">
            
                    
                    Configure and Manage
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1.1" data-path="../vic_cloud_admin/logging_in_mp.html">
            
                <a href="../vic_cloud_admin/logging_in_mp.html">
            
                    
                    Logging In to the Management Portal
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.2" data-path="../vic_cloud_admin/configure_system.html">
            
                <a href="../vic_cloud_admin/configure_system.html">
            
                    
                    Configure System Settings
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.3" data-path="../vic_cloud_admin/add_cloud_admins.html">
            
                <a href="../vic_cloud_admin/add_cloud_admins.html">
            
                    
                    Add Cloud Administrators
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.4" data-path="../vic_cloud_admin/add_users.html">
            
                <a href="../vic_cloud_admin/add_users.html">
            
                    
                    Add Viewers, Developers, or DevOps Administrators to Projects
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.5" data-path="../vic_cloud_admin/vchs_and_mgmt_portal.html">
            
                <a href="../vic_cloud_admin/vchs_and_mgmt_portal.html">
            
                    
                    View and Manage VCHs
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1.5.1" data-path="../vic_cloud_admin/add_vch_noTLS_in_portal.html">
            
                <a href="../vic_cloud_admin/add_vch_noTLS_in_portal.html">
            
                    
                    Add Hosts with No TLS Authentication to the Management Portal
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.5.2" data-path="../vic_cloud_admin/add_vch_serversideTLS_in_portal.html">
            
                <a href="../vic_cloud_admin/add_vch_serversideTLS_in_portal.html">
            
                    
                    Add Hosts with Server-Side TLS Authentication to the Management Portal
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.5.3" data-path="../vic_cloud_admin/add_vch_fullTLS_in_portal.html">
            
                <a href="../vic_cloud_admin/add_vch_fullTLS_in_portal.html">
            
                    
                    Add Hosts with Full TLS Authentication to the Management Portal
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.1.6" data-path="../vic_cloud_admin/add_repos_in_portal.html">
            
                <a href="../vic_cloud_admin/add_repos_in_portal.html">
            
                    
                    Add Registries
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.7" data-path="../vic_cloud_admin/create_projects.html">
            
                <a href="../vic_cloud_admin/create_projects.html">
            
                    
                    Create a Project
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1.7.1" data-path="../vic_cloud_admin/manage_projects.html">
            
                <a href="../vic_cloud_admin/manage_projects.html">
            
                    
                    Manage Projects
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.7.2" data-path="../vic_cloud_admin/access_project_logs.html">
            
                <a href="../vic_cloud_admin/access_project_logs.html">
            
                    
                    Access Project Logs
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.7.3" data-path="../vic_cloud_admin/manage_repository_registry.html">
            
                <a href="../vic_cloud_admin/manage_repository_registry.html">
            
                    
                    Manage Repositories
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.1.8" data-path="../vic_cloud_admin/replicating_images.html">
            
                <a href="../vic_cloud_admin/replicating_images.html">
            
                    
                    Replicating Images
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1.8.1" data-path="../vic_cloud_admin/create_replication_endpoints.html">
            
                <a href="../vic_cloud_admin/create_replication_endpoints.html">
            
                    
                    Create Replication Endpoints
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.8.2" data-path="../vic_cloud_admin/create_replication_rules.html">
            
                <a href="../vic_cloud_admin/create_replication_rules.html">
            
                    
                    Create Replication Rules
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.8.3" data-path="../vic_cloud_admin/manage_replication_endpoints.html">
            
                <a href="../vic_cloud_admin/manage_replication_endpoints.html">
            
                    
                    Manage Replication Endpoints
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.1.9" data-path="../vic_cloud_admin/creating_placements.html">
            
                <a href="../vic_cloud_admin/creating_placements.html">
            
                    
                    Create and Manage Container Placements
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="4.1" data-path="../vic_app_dev/">
            
                <a href="../vic_app_dev/">
            
                    
                    Develop Container Apps
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1.1" data-path="../vic_app_dev/manage_project.html">
            
                <a href="../vic_app_dev/manage_project.html">
            
                    
                    Manage a Development Project
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1.1.1" data-path="../vic_app_dev/assign_users.html">
            
                <a href="../vic_app_dev/assign_users.html">
            
                    
                    Assign Users to a Project
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.1.2" data-path="../vic_app_dev/manage_project_members.html">
            
                <a href="../vic_app_dev/manage_project_members.html">
            
                    
                    Manage Project Members
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.1.3" data-path="../vic_app_dev/create_network.html">
            
                <a href="../vic_app_dev/create_network.html">
            
                    
                    Create New Networks for Provisioning Containers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.1.4" data-path="../vic_app_dev/provision_containers_portal.html">
            
                <a href="../vic_app_dev/provision_containers_portal.html">
            
                    
                    Provisioning Container VMs in the Management Portal
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1.1.4.1" data-path="../vic_app_dev/configuring_links.html">
            
                <a href="../vic_app_dev/configuring_links.html">
            
                    
                    Configuring Links for Templates and Images
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.1.4.2" data-path="../vic_app_dev/configuring_health_checks.html">
            
                <a href="../vic_app_dev/configuring_health_checks.html">
            
                    
                    Configuring Health Checks for Templates and Images
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.1.4.3" data-path="../vic_app_dev/configuring_clusters.html">
            
                <a href="../vic_app_dev/configuring_clusters.html">
            
                    
                    Configuring Cluster Size and Scale
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.1.2" data-path="../vic_app_dev/using_as_developer.html">
            
                <a href="../vic_app_dev/using_as_developer.html">
            
                    
                    Using as a Developer
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1.2.1" data-path="../vic_app_dev/container_operations.html">
            
                <a href="../vic_app_dev/container_operations.html">
            
                    
                    Supported Docker Commands
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1.2.1.1" data-path="../vic_app_dev/docker_compose_file_options.html">
            
                <a href="../vic_app_dev/docker_compose_file_options.html">
            
                    
                    Supported Docker Compose File Options
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.2.1.2" data-path="../vic_app_dev/dockerfile_support.html">
            
                <a href="../vic_app_dev/dockerfile_support.html">
            
                    
                    Supported Dockerfile Instructions
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.1.2.2" data-path="../vic_app_dev/container_limitations.html">
            
                <a href="../vic_app_dev/container_limitations.html">
            
                    
                    Use and Limitations
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.2.3" data-path="../vic_app_dev/obtain_vch.html">
            
                <a href="../vic_app_dev/obtain_vch.html">
            
                    
                    Obtain a VCH
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.2.4" data-path="../vic_app_dev/configure_docker_client.html">
            
                <a href="../vic_app_dev/configure_docker_client.html">
            
                    
                    Configure the Docker Client
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.2.5" data-path="../vic_app_dev/build_push_images.html">
            
                <a href="../vic_app_dev/build_push_images.html">
            
                    
                    Building and Pushing Images
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.2.6" data-path="../vic_app_dev/using_volumes_with_vic.html">
            
                <a href="../vic_app_dev/using_volumes_with_vic.html">
            
                    
                    Using Volumes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.2.7" data-path="../vic_app_dev/network_use_cases.html">
            
                <a href="../vic_app_dev/network_use_cases.html">
            
                    
                    Container Networking
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.2.8" data-path="../vic_app_dev/creating_containerized_app_with_vic.html">
            
                <a href="../vic_app_dev/creating_containerized_app_with_vic.html">
            
                    
                    Creating a Containerized App
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1.2.8.1" data-path="../vic_app_dev/putting_apps_into_production.html">
            
                <a href="../vic_app_dev/putting_apps_into_production.html">
            
                    
                    Putting Apps into Production
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.2.8.2" data-path="../vic_app_dev/deploy_single_containervm.html">
            
                <a href="../vic_app_dev/deploy_single_containervm.html">
            
                    
                    Deploy a Single Container VM
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.2.8.3" data-path="../vic_app_dev/deploy_multiple_docker_compose.html">
            
                <a href="../vic_app_dev/deploy_multiple_docker_compose.html">
            
                    
                    Deploy Container VMs with Compose
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.1.3" data-path="../vic_app_dev/ts_volume_store_error.html">
            
                <a href="../vic_app_dev/ts_volume_store_error.html">
            
                    
                    Default Volume Store Error
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="5.1" data-path="feedback.html">
            
                <a href="feedback.html">
            
                    
                    Send Doc Feedback
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2" data-path="../pdf.html">
            
                <a href="../pdf.html">
            
                    
                    Download PDF
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Advanced Examples of Deploying a VCH</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="advanced-examples-of-deploying-a-vch">Advanced Examples of Deploying a VCH</h1>
<p>This topic provides examples of the options of the <code>vic-machine create</code> command to use when deploying virtual container hosts (VCHs) in various vSphere configurations.</p>
<ul>
<li><a href="#general">General Deployment Examples</a><ul>
<li><a href="#cluster">Deploy to a vCenter Server Cluster with Multiple Datacenters and Datastores</a></li>
<li><a href="#standalone">Deploy to a Specific Standalone Host in vCenter Server</a></li>
<li><a href="#rp_host">Deploy to a Resource Pool on an ESXi Host</a></li>
<li><a href="#rp_cluster">Deploy to a Resource Pool in a vCenter Server Cluster</a></li>
<li><a href="#customized">Set Limits on Resource Use</a></li>
</ul>
</li>
<li><a href="#networking">Networking Examples</a><ul>
<li><a href="#networks">Specify Public, Management, Client, and Container Networks</a></li>
<li><a href="#static-ip">Set a Static IP Address for the VCH Endpoint VM on the Different Networks</a></li>
<li><a href="#ip-range">Configure a Non-DHCP Container Network</a></li>
<li><a href="#proxy">Configure a Proxy Server</a></li>
</ul>
</li>
<li><a href="#volume-stores">Specify One or More Volume Stores</a></li>
<li><a href="#security">Security Examples</a><ul>
<li><a href="#auto_cert">Use Auto-Generated Trusted CA Certificates</a></li>
<li><a href="#custom_cert">Use Custom Server Certificates</a></li>
<li><a href="#certcombo">Combine Custom Server Certificates and Auto-Generated Client Certificates</a></li>
<li><a href="#ops-user">Specify Different User Accounts for VCH Deployment and Operation</a></li>
</ul>
</li>
<li><a href="#regserv">Registry Server Examples</a><ul>
<li><a href="#registry">Authorize Access to an Insecure Private Registry Server</a></li>
<li><a href="#secureregistry">Authorize Access to Secure Registries and vSphere Integrated Containers Registry</a></li>
</ul>
</li>
</ul>
<p>For simplicity, all examples that do not relate explicitly to certificate use specify the <code>--no-tls</code> option.</p>
<p>For detailed descriptions of all of the <code>vic-machine create</code> options, see <a href="vch_installer_options.html">VCH Deployment Options</a>. For information about how to obtain the certificate thumbprint before running <code>vic-machine</code>, see <a href="obtain_thumbprint.html">Obtain the Certificate Thumbprint of vCenter Server or an ESXi Host</a>. </p>
<p><strong>NOTE</strong>: Wrap any option arguments that include spaces or special characters in quotes. Use single quotes if you are using <code>vic-machine</code> on a Linux or Mac OS system and double quotes on a Windows system.</p>
<p>Option arguments that might require quotation marks include the following:</p>
<ul>
<li>User names and passwords in <code>--target</code>, <code>--user</code>, <code>--password</code>, <code>--ops-user</code>, and <code>--ops-password</code>.</li>
<li>Datacenter names in <code>--target</code>.</li>
<li>VCH names in <code>--name</code>.</li>
<li>Datastore names and paths in <code>--image-store</code> and <code>--volume-store</code>.</li>
<li>Network and port group names in all networking options.</li>
<li>Cluster and resource pool names in <code>--compute-resource</code>.</li>
<li>Folder names in the paths for <code>--tls-cert-path</code>, <code>--tls-server-cert</code>, <code>--tls-server-key</code>, <code>--appliance-iso</code>, and <code>--bootstrap-iso</code>.</li>
</ul>
<h2 id="general-deployment-examples-">General Deployment Examples <a id="general"></a></h2>
<p>The examples in this section demonstrate the deployment of VCHs in different vSphere environments.</p>
<h3 id="deploy-to-a-vcenter-server-cluster-with-multiple-datacenters-and-datastores-">Deploy to a vCenter Server Cluster with Multiple Datacenters and Datastores <a id="cluster"></a></h3>
<p>If vCenter Server has more than one datacenter, you specify the datacenter in the <code>--target</code> option.</p>
<p>If vCenter Server manages more than one cluster, you use the <code>--compute-resource</code> option to specify the cluster on which to deploy the VCH.</p>
<p>When deploying a VCH to vCenter Server, you must use the <code>--bridge-network</code> option to specify an existing port group for container VMs to use to communicate with each other. For information about how to create a distributed virtual switch and port group, see the section on vCenter Server Network Requirements in <a href="vic_installation_prereqs.html#networkreqs">Environment Prerequisites for VCH Deployment</a>.</p>
<p>This example deploys a VCH with the following configuration:</p>
<ul>
<li>Provides the vCenter Single Sign-On user and password in the <code>--target</code> option. The user name is wrapped in quotes, because it contains the <code>@</code> character.</li>
<li>Deploys a VCH named <code>vch1</code> to the cluster <code>cluster1</code> in datacenter <code>dc1</code>. </li>
<li>Uses a port group named <code>vic-bridge</code> for the bridge network. </li>
<li>Designates <code>datastore1</code> as the datastore in which to store container images, the files for the VCH appliance, and container VMs. </li>
</ul>
<pre>vic-machine-<i>operating_system</i> create
--target &apos;Administrator@vsphere.local&apos;:<i>password</i>@<i>vcenter_server_address</i>/dc1
--compute-resource cluster1
--image-store datastore1
--bridge-network vch1-bridge
--name vch1
--thumbprint <i>certificate_thumbprint</i>
--no-tls
</pre>


<h3 id="deploy-to-a-specific-standalone-host-in-vcenter-server-">Deploy to a Specific Standalone Host in vCenter Server <a id="standalone"></a></h3>
<p>If vCenter Server manages multiple standalone ESXi hosts that are not part of a cluster, you use the <code>--compute-resource</code> option to specify the address of the ESXi host to which to deploy the VCH.</p>
<p>This example deploys a VCH with the following configuration:</p>
<ul>
<li>Specifies the user name, password, image store, bridge network, and name for the VCH.</li>
<li>Deploys the VCH on the ESXi host with the FQDN <code>esxihost1.organization.company.com</code> in the datacenter <code>dc1</code>. You can also specify an IP address.</li>
</ul>
<pre>vic-machine-<i>operating_system</i> create
--target &apos;Administrator@vsphere.local&apos;:<i>password</i>@<i>vcenter_server_address</i>/dc1
--image-store datastore1
--bridge-network vch1-bridge
--compute-resource esxihost1.organization.company.com
--name vch1
--thumbprint <i>certificate_thumbprint</i>
--no-tls
</pre>


<h3 id="deploy-to-a-resource-pool-on-an-esxi-host-">Deploy to a Resource Pool on an ESXi Host <a id="rp_host"></a></h3>
<p>To deploy a VCH in a specific resource pool on an ESXi host that is not managed by vCenter Server, you specify the resource pool name in the <code>--compute-resource</code> option. </p>
<p>This example deploys a VCH with the following configuration:</p>
<ul>
<li>Specifies the user name and password, image store, and a name for the VCH.</li>
<li>Designates <code>rp 1</code> as the resource pool in which to place the VCH. The resource pool name is wrapped in quotes, because it contains a space.</li>
</ul>
<pre>vic-machine-<i>operating_system</i> create
--target root:<i>password</i>@<i>esxi_host_address</i>
--compute-resource &apos;rp 1&apos;
--image-store datastore1
--name vch1
--thumbprint <i>certificate_thumbprint</i>
--no-tls
</pre>


<h3 id="deploy-to-a-resource-pool-in-a-vcenter-server-cluster-">Deploy to a Resource Pool in a vCenter Server Cluster <a id="rp_cluster"></a></h3>
<p>To deploy a VCH in a resource pool in a vCenter Server cluster, you specify the resource pool in the <code>compute-resource</code> option.</p>
<p>This example deploys a VCH with the following configuration:</p>
<ul>
<li>Specifies the user name, password, datacenter, image store, bridge network, and name for the VCH.</li>
<li>Designates <code>rp 1</code> as the resource pool in which to place the VCH. In this example, the resource pool name <code>rp 1</code> is unique across all hosts and clusters, so you only need to specify the resource pool name.</li>
</ul>
<pre>vic-machine-<i>operating_system</i> create
--target &apos;Administrator@vsphere.local&apos;:<i>password</i>@<i>vcenter_server_address</i>/dc1
--compute-resource &apos;rp 1&apos;
--image-store datastore1
--bridge-network vch1-bridge
--name vch1
--thumbprint <i>certificate_thumbprint</i>
--no-tls
</pre>

<p>If the name of the resource pool is not unique across all clusters, for example if two clusters each contain a resource pool named <code>rp 1</code>, you must specify the full path to the resource pool in the <code>compute-resource</code> option, in the format <i>cluster_name</i>/Resources/<i>resource_pool_name</i>.</p>
<pre>vic-machine-<i>operating_system</i> create
--target &apos;Administrator@vsphere.local&apos;:<i>password</i>@<i>vcenter_server_address</i>/dc1
--compute-resource &apos;cluster 1&apos;/Resources/&apos;rp 1&apos;
--image-store datastore1
--bridge-network vch1-bridge
--name vch1
--thumbprint <i>certificate_thumbprint</i>
--no-tls
</pre>

<h3 id="set-limits-on-resource-use-">Set Limits on Resource Use <a id="customized"></a></h3>
<p>To limit the amount of system resources that the container VMs in a VCH can use, you can set resource limits on the VCH vApp. </p>
<p>This example deploys a VCH with the following configuration:</p>
<ul>
<li>Specifies the user name, password, image store, cluster, bridge network, and name for the VCH.</li>
<li>Sets resource limits on the VCH by imposing memory and CPU reservations, limits, and shares.</li>
</ul>
<pre>vic-machine-<i>operating_system</i> create
--target &apos;Administrator@vsphere.local&apos;:<i>password</i>@<i>vcenter_server_address</i>/dc1
--compute-resource cluster1
--image-store datastore1
--bridge-network vch1-bridge
--memory 1024
--memory-reservation 1024
--memory-shares low
--cpu 1024
--cpu-reservation 1024
--cpu-shares low
--name vch1
--thumbprint <i>certificate_thumbprint</i>
--no-tls
</pre>

<p>For more information about setting resource use limitations on VCHs, see the <a href="vch_installer_options.html#deployment">Advanced Deployment Options</a> and <a href="vch_installer_options.html#adv-mgmt">Advanced Resource Management Options</a> sections in VCH Deployment Options.</p>
<h2 id="networking-examples-">Networking Examples <a id="networking"></a></h2>
<p>The examples in this section demonstrate how to direct traffic to and from VCHs and the other elements in your environment, how to set static IPs, how to configure container VM networks, and how to configure a VCH to use a proxy server.</p>
<h3 id="specify-public-management-and-client-networks-">Specify Public, Management, and Client Networks <a id="networks"></a></h3>
<p>In addition to the mandatory bridge network, if your vCenter Server environment includes multiple networks, you can direct different types of traffic to different networks. </p>
<ul>
<li>You can direct the traffic between the VCH and the Internet to a specific network by specifying the <code>--public-network</code> option. Any container VM traffic that routes through the VCH also uses the public network. If you do not specify the <code>--public-network</code> option, the VCH uses the VM Network for public network traffic.</li>
<li>You can direct traffic between ESXi hosts, vCenter Server, and the VCH to a specific network by specifying the <code>--management-network</code> option. If you do not specify the <code>--management-network</code> option, the VCH uses the public network for management traffic.</li>
<li>You can designate a specific network for use by the Docker API by specifying the <code>--client-network</code> option. If you do not specify the <code>--client-network</code> option, the Docker API uses the public network.</li>
</ul>
<p><strong>IMPORTANT</strong>: A VCH supports a maximum of 3 distinct network interfaces. Because the bridge network requires its own port group, at least two of the public, client, and management networks must share a network interface and therefore a port group. Container networks do not go through the VCH, so they are not subject to this limitation. This limitation will be removed in a future release.</p>
<p>This example deploys a VCH with the following configuration:</p>
<ul>
<li>Specifies the user name, password, datacenter, cluster, image store, bridge network, and name for the VCH.</li>
<li>Directs public and management traffic to network 1 and Docker API traffic to network 2.</li>
</ul>
<pre>vic-machine-<i>operating_system</i> create
--target &apos;Administrator@vsphere.local&apos;:<i>password</i>@<i>vcenter_server_address</i>/dc1
--compute-resource cluster1
--image-store datastore1
--bridge-network vch1-bridge
--public-network &apos;network 1&apos;
--management-network &apos;network 1&apos;
--client-network &apos;network 2&apos;
--name vch1
--thumbprint <i>certificate_thumbprint</i>
--no-tls
</pre>

<p>For more information about the networking options, see the <a href="vch_installer_options.html#networking">Networking Options section</a> in VCH Deployment Options.</p>
<h3 id="set-a-static-ip-address-for-the-vch-endpoint-vm-on-the-different-networks-">Set a Static IP Address for the VCH Endpoint VM on the Different Networks <a id="static-ip"></a></h3>
<p>If you specify networks for any or all of the public, management, and client networks, you can deploy the VCH so that the VCH endpoint VM has a static IP address on one or more of those networks.  </p>
<p>This example deploys a VCH with the following configuration:</p>
<ul>
<li>Specifies the user name, password, datacenter, cluster, image store, bridge network, and name for the VCH.</li>
<li>Directs public and management traffic to network 1 and Docker API traffic to network 2.</li>
<li>Sets a DNS server for use by the public, management, and client networks.</li>
<li>Sets a static IP address and subnet mask for the VCH endpoint VM on the public and client networks. Because the management network shares a network with the public network, you only need to specify the public network IP address. You cannot specify a management IP address because you are sharing a port group between the management and public network.</li>
<li>Specifies the gateway for the public network. If you set a static IP address on the public network, you must also specify the gateway address.</li>
<li>Does not specify a gateway for the client network. It is not necessary to specify a gateway on either of the client or management networks if those networks are L2 adjacent to their gateways.</li>
<li>Because this example specifies a static IP address for the VCH endpoint VM on the client network, <code>vic-machine create</code> uses this address as the Common Name with which to create auto-generated trusted certificates. Full TLS authentication is implemented by default, so no TLS options are specified. </li>
</ul>
<pre>vic-machine-<i>operating_system</i> create
--target &apos;Administrator@vsphere.local&apos;:<i>password</i>@<i>vcenter_server_address</i>/dc1
--compute-resource cluster1
--image-store datastore1
--bridge-network vch1-bridge
--public-network &apos;network 1&apos;
--public-network-ip 192.168.1.10/24
--public-network-gateway 192.168.1.1
--management-network &apos;network 1&apos;
--client-network &apos;network 2&apos;
--client-network-ip 192.168.3.10/24
--dns-server <i>dns_server_address</i>
--thumbprint <i>certificate_thumbprint</i>
--name vch1
</pre>

<p>For more information about setting static IP addresses, see the <a href="vch_installer_options.html#static-ip">Specify a Static IP Address for the VCH Endpoint VM</a> in VCH Deployment Options.</p>
<h3 id="configure-a-non-dhcp-network-for-container-vms-">Configure a Non-DHCP Network for Container VMs <a id="ip-range"></a></h3>
<p>You can designate a specific network for container VMs to use by specifying the <code>--container-network</code> option. Containers use this network if the container developer runs <code>docker run</code> or <code>docker create</code> specifying the <code>--net</code> option with one of the specified container networks when they run or create a container. This option requires a port group that must exist before you run <code>vic-machine create</code>. You cannot use the same port group that you use for the bridge network. You can provide a descriptive name for the network, for use by Docker. If you do not specify a descriptive name, Docker uses the vSphere network name. For example, the descriptive name appears as an available network in the output of <code>docker info</code> and <code>docker network ls</code>. </p>
<p>If the network that you designate as the container network in the <code>--container-network</code> option does not support DHCP, you can configure the gateway, DNS server, and a range of IP addresses for container VMs to use.  You must specify <code>--container-network-ip-range</code> if container developers need to deploy containers with static IP addresses. </p>
<p>This example deploys a VCH with the following configuration:</p>
<ul>
<li>Specifies the user name, password, datacenter, cluster, image store, bridge network, and name for the VCH.</li>
<li>Uses the VM Network for the public, management, and client networks.</li>
<li>Designates a port group named <code>vic-containers</code> for use by container VMs that are run with the <code>--net</code> option.</li>
<li>Gives the container network the name <code>vic-container-network</code>, for use by Docker. </li>
<li>Specifies the gateway, two DNS servers, and a range of IP addresses on the container network for container VMs to use.</li>
<li>Opens the firewall on the container network for outbound connections.</li>
</ul>
<pre>vic-machine-<i>operating_system</i> create
--target &apos;Administrator@vsphere.local&apos;:<i>password</i>@<i>vcenter_server_address</i>/dc1
--compute-resource cluster1
--image-store datastore1
--bridge-network vch1-bridge
--container-network vic-containers:vic-container-network
--container-network-gateway vic-containers:<i>gateway_ip_address</i>/24
--container-network-dns vic-containers:<i>dns1_ip_address</i>
--container-network-dns vic-containers:<i>dns2_ip_address</i>
--container-network-ip-range vic-containers:192.168.100.0/24
--container-network-firewall vic-containers:outbound
--name vch1
--thumbprint <i>certificate_thumbprint</i>
--no-tls
</pre>

<p>For more information about the container network options, see the <a href="vch_installer_options.html#container-network"><code>--container-network</code></a> and  <a href="vch_installer_options.html#adv-container-net">Configure Container Networks</a> sections in VCH Deployment Options.</p>
<h3 id="configure-a-proxy-server-">Configure a Proxy Server <a id="proxy"></a></h3>
<p>If your network access is controlled by a proxy server, you must   configure a VCH to connect to the proxy server when you deploy it, so that it can pull images from external sources.</p>
<p>This example deploys a VCH with the following configuration:</p>
<ul>
<li>Specifies the user name, password, image store, cluster, bridge network, and name for the VCH.</li>
<li>Configures the VCH to access the network via an HTTPS proxy server.</li>
</ul>
<pre>vic-machine-<i>operating_system</i> create
--target &apos;Administrator@vsphere.local&apos;:<i>password</i>@<i>vcenter_server_address</i>/dc1
--compute-resource cluster1
--image-store datastore1
--bridge-network vch1-bridge
--https-proxy https://<i>proxy_server_address</i>:<i>port</i>
--name vch1
--thumbprint <i>certificate_thumbprint</i>
--no-tls
</pre>



<h2 id="specify-volume-stores-">Specify Volume Stores <a id="volume-stores"></a></h2>
<p>If container application developers will use the <code>docker volume create</code> command to create containers that use volumes, you must create volume stores when you deploy VCHs. You specify volume stores in the <code>--volume-store</code> option. You can specify <code>--volume-store</code> multiple times to create multiple volume stores. </p>
<p>When you create a volume store, you specify the name of the datastore to use and an optional path to a folder on that datastore. You also specify a descriptive name for that volume store for use by Docker.</p>
<p>This example deploys a VCH with the following configuration:</p>
<ul>
<li>Specifies the user name, password, datacenter, cluster, bridge network, and name for the VCH.</li>
<li>Specifies the <code>volumes</code> folder on <code>datastore 1</code> as the default volume store. Creating a volume store named <code>default</code> allows container application developers to create anonymous or named volumes by using <code>docker create -v</code>. </li>
<li>Specifies a second volume store named <code>volume_store_2</code> in the <code>volumes</code> folder on <code>datastore 2</code>. </li>
<li>Specifies a volume store named <code>shared_volume</code> in a NFS share point, from which containers can mount shared volumes.</li>
</ul>
<pre>vic-machine-<i>operating_system</i> create
--target &apos;Administrator@vsphere.local&apos;:<i>password</i>@<i>vcenter_server_address</i>/dc1
--compute-resource cluster1
--bridge-network vch1-bridge
--image-store &apos;datastore 1&apos;
--volume-store &apos;datastore 1&apos;/volumes:default
--volume-store &apos;datastore 2&apos;/volumes:volume_store_2
--volume-store nfs://nfs_store/path/to/share/point:shared_volume
--name vch1
--thumbprint <i>certificate_thumbprint</i>
--no-tls
</pre>

<p>For more information about volume stores, see the <a href="vch_installer_options.html#volume-store">volume-store section</a> in VCH Deployment Options. </p>
<h2 id="security-examples-">Security Examples <a id="security"></a></h2>
<p>The examples in this section demonstrate how to configure a VCH to use Certificate Authority (CA) certificates to enable <code>TLSVERIFY</code> in your Docker environment, and to allow access to insecure registries of Docker images.</p>
<h3 id="use-auto-generated-trusted-ca-certificates-">Use Auto-Generated Trusted CA Certificates <a id="auto_cert"></a></h3>
<p>You can deploy a VCH that implements two-way authentication with trusted auto-generated TLS certificates that are signed by a CA. </p>
<p>To automatically generate a server certificate that can pass client verification, you must specify the Common Name (CN) for the certificate by using the <a href="vch_installer_options.html#tls-cname"><code>--tls-cname</code></a> option. The CN should be the FQDN or IP address of the server, or a domain with a wildcard. The CN value must match the name or address that clients will use to connect to the server. You can use the <code>--organization</code> option to add basic descriptive information to the server certificate. This information is visible to clients if they inspect the server certificate.</p>
<p>If you specify an existing CA file with which to validate clients, you must also provide an existing server certificate that is compatible with the <code>--tls-cname</code> value or the IP address of the client interface.</p>
<p>This example deploys a VCH with the following configuration:</p>
<ul>
<li>Specifies the user, password, datacenter, image store, cluster, bridge network, and name for the VCH.</li>
<li>Provides a wildcard domain <code>*.example.org</code> as the FQDN for the VCH, for use as the Common Name in the certificate. This assumes that there is a DHCP server offering IP addresses on VM Network, and that those addresses have corresponding DNS entries such as <code>dhcp-a-b-c.example.com</code>.</li>
<li>Specifies a folder in which to store the auto-generated certificates.</li>
</ul>
<pre>vic-machine-<i>operating_system</i> create
--target &apos;Administrator@vsphere.local&apos;:<i>password</i>@<i>vcenter_server_address</i>/dc1
--compute-resource cluster1
--image-store datastore1
--bridge-network vch1-bridge
--tls-cname *.example.org
--tls-cert-path <i>path_to_cert_folder</i>
--thumbprint <i>certificate_thumbprint</i>
--name vch1
</pre>

<p>The Docker API for this VCH will be accessible at <code>https://dhcp-a-b-c.example.com:2376</code>.</p>
<p>For more information about using auto-generated CA certificates, see the section <a href="vch_installer_options.html#restrict_auto">Restrict Access to the Docker API with Auto-Generated Certificates</a> in VCH Deployment Options.</p>
<h3 id="use-custom-server-certificates-">Use Custom Server Certificates <a id="custom_cert"></a></h3>
<p>You can create a VCH that uses a custom server certificate, for example  a server certificate that has been signed by Verisign or another public root. You use the <code>--tls-server-cert</code> and <code>--tls-server-key</code> options to provide the paths to a custom X.509 certificate and its key when you deploy a VCH. The paths to the certificate and key files must be relative to the location from which you are running <code>vic-machine create</code>.</p>
<p>This example deploys a VCH with the following configuration:</p>
<ul>
<li>Specifies the user name, password, image store, cluster, bridge network, and name for the VCH.</li>
<li>Provides the paths relative to the current location of the <code>*.pem</code> files for the custom server certificate and key files.</li>
</ul>
<pre>vic-machine-<i>operating_system</i> create
--target &apos;Administrator@vsphere.local&apos;:<i>password</i>@<i>vcenter_server_address</i>/dc1
--compute-resource cluster1
--image-store datastore1
--bridge-network vch1-bridge
--tls-server-cert ../some/relative/path/<i>certificate_file</i>.pem
--tls-server-key ../some/relative/path/<i>key_file</i>.pem
--name vch1
--thumbprint <i>certificate_thumbprint</i>
</pre>

<p>For more information about using custom server certificates, see the section <a href="vch_installer_options.html#restrict_custom">Restrict Access to the Docker API with Custom Certificates</a> in VCH Deployment Options.</p>
<h3 id="combine-custom-server-certificates-and-auto-generated-client-certificates-">Combine Custom Server Certificates and Auto-Generated Client Certificates <a id="certcombo"></a></h3>
<p>You can create a VCH with a custom server certificate by specifying the paths to custom <code>server-cert.pem</code> and <code>server-key.pem</code> files in the <code>--tls-server-cert</code> and <code>--tls-server-key</code> options. The key should be un-encrypted. Specifying the <code>--tls-server-cert</code> and <code>--tls-server-key</code> options for the server certificate does not affect the automatic generation of client certificates. If you specify the <code>--tls-cname</code> option to match the common name value of the server certificate, <code>vic-machine create</code> generates self-signed certificates for Docker client authentication and deployment of the VCH succeeds.</p>
<p>This example deploys a VCH with the following configuration:</p>
<ul>
<li>Specifies the user name, password, image store, cluster, bridge network, and name for the VCH.</li>
<li>Provides the paths relative to the current location of the <code>*.pem</code> files for the custom server certificate and key files.</li>
<li>Specifies the common name from the server certificate in the <code>--tls-cname</code> option. The <code>--tls-cname</code> option is used in this case to ensure that the certificate is valid for the resulting VCH, given the network configuration.</li>
</ul>
<pre>vic-machine-<i>operating_system</i> create
--target &apos;Administrator@vsphere.local&apos;:<i>password</i>@<i>vcenter_server_address</i>/dc1
--compute-resource cluster1
--image-store datastore1
--bridge-network vch1-bridge
--tls-server-cert ../some/relative/path/<i>certificate_file</i>.pem
--tls-server-key ../some/relative/path/<i>key_file</i>.pem
--tls-cname <i>cname_from_server_cert</i>
--name vch1
--thumbprint <i>certificate_thumbprint</i>
</pre>

<h3 id="specify-different-user-accounts-for-vch-deployment-and-operation-">Specify Different User Accounts for VCH Deployment and Operation <a id="ops-user"></a></h3>
<p>When you deploy a VCH, you can use different vSphere user accounts for deployment and for operation. This allows you to run VCHs with lower levels of privileges than are required for deployment.</p>
<p>This example deploys a VCH with the following configuration:</p>
<ul>
<li>Specifies the image store and name for the VCH.</li>
<li>Specifies <i>vsphere_admin</i> in the <code>--target</code> option, to identify the user account with vSphere Administrator privileges with which to deploy the VCH.</li>
<li>Specifies <i>vsphere_user</i> and its password in the <code>--ops-user</code> and <code>--ops-password</code> options, to identify the user account with which the VCH runs. The user account that you specify in <code>--ops-user</code> must  is different to the vSphere Administrator account that you use for deployment, and must exist before you deploy the VCH. </li>
<li>Specifies a resource pool in which to deploy the VCH in the <code>--compute-resource</code> option.</li>
<li>Specifies the VCH port groups in the <code>--bridge-network</code> and <code>--container-network</code> options.</li>
</ul>
<pre>vic-machine-<i>operating_system</i> create
--target <i>vsphere_admin</i>:<i>vsphere_admin_password</i>@<i>vcenter_server_address</i>/dc1
--compute-resource cluster1/VCH_pool
--image-store datastore1
--bridge-network vch1-bridge
--container-network vic-containers:vic-container-network
--name vch1
--ops-user <i>vsphere_user</i>
--ops-password <i>vsphere_user_password</i>
--thumbprint <i>certificate_thumbprint</i>
--no-tls
</pre>

<p>For information about the permissions that the <code>--ops-user</code> account requires, and the permissions to set on the resource pool for the VCH and on the network folders, see <a href="set_up_ops_user.html">Use Different User Accounts for VCH Deployment and Operation</a>.</p>
<h2 id="registry-server-examples-">Registry Server Examples <a id="regserv"></a></h2>
<p>The examples in this section demonstrate how to configure a VCH to use a private registry server, for example vSphere Integrated Containers Registry.</p>
<h3 id="authorize-access-to-an-insecure-private-registry-server-">Authorize Access to an Insecure Private Registry Server <a id="registry"></a></h3>
<p>To authorize connections from a VCH to a private registry server without verifying the certificate of that registry, set the <code>--insecure-registry</code> option. If you authorize a VCH to connect to an insecure private registry server, the VCH attempts to access the registry server via HTTP if access via HTTPS fails. VCHs always use HTTPS when connecting to registry servers for which you have not authorized insecure access. You can specify <code>insecure-registry</code> multiple times to allow connections from the VCH to multiple insecure private registry servers.</p>
<p><strong>NOTE</strong>: You cannot configure VCHs to connect to vSphere Integrated Containers Registry instances as insecure registries. Connections to vSphere Integrated Containers Registry always require HTTPS and a certificate.</p>
<p>This example deploys a VCH with the following configuration:</p>
<ul>
<li>Specifies the user name, password, image store, cluster, bridge network, and name for the VCH.</li>
<li>Authorizes the VCH to pull Docker images from the insecure private registry servers located at the URLs <i>registry_URL_1</i> and <i>registry_URL_2</i>.</li>
<li>The registry server at <i>registry_URL_2</i> listens for connections on port 5000. </li>
</ul>
<pre>vic-machine-<i>operating_system</i> create
--target &apos;Administrator@vsphere.local&apos;:<i>password</i>@<i>vcenter_server_address</i>/dc1
--compute-resource cluster1
--image-store datastore1
--bridge-network vch1-bridge
--insecure-registry <i>registry_URL_1</i>
--insecure-registry <i>registry_URL_2:5000</i>
--name vch1
--thumbprint <i>certificate_thumbprint</i>
--no-tls
</pre>

<p>For more information about configuring VCHs to allow connections to insecure private registry servers, see the section on the <a href="vch_installer_options.html#insecure-registry"><code>insecure-registry</code> option</a> in VCH Deployment Options.</p>
<h3 id="authorize-access-to-secure-registries-and-vsphere-integrated-containers-registry-">Authorize Access to Secure Registries and vSphere Integrated Containers Registry <a id="secureregistry"></a></h3>
<p>For an example of how to use <code>--registry-ca</code> to authorize access to vSphere Integrated Containers Registry or to another secure registry, see <a href="deploy_vch_registry.html">Deploy a VCH for Use with vSphere Integrated Containers Registry</a>.</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="vic_env_variables.html" class="navigation navigation-prev " aria-label="Previous page: Set Environment Variables">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="deploy_vch_registry.html" class="navigation navigation-next " aria-label="Next page: Deploy a VCH for Use with vSphere Integrated Containers Registry">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Advanced Examples of Deploying a VCH","level":"2.1.4.9","depth":3,"next":{"title":"Deploy a VCH for Use with vSphere Integrated Containers Registry","level":"2.1.4.10","depth":3,"path":"vic_vsphere_admin/deploy_vch_registry.md","ref":"vic_vsphere_admin/deploy_vch_registry.md","articles":[]},"previous":{"title":"Set Environment Variables","level":"2.1.4.8","depth":3,"path":"vic_vsphere_admin/vic_env_variables.md","ref":"vic_vsphere_admin/vic_env_variables.md","articles":[]},"dir":"ltr"},"config":{"plugins":["expandable-chapters","edit-link"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"edit-link":{"label":"Edit this Page","base":"https://github.com/vmware/vic-product/tree/master/docs/user_doc"},"expandable-chapters":{},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageBreaksBefore":"/","headerTemplate":"_TITLE_","paperSize":"letter","margin":{"right":62,"left":62,"top":56,"bottom":56},"fontSize":12,"fontFamily":"Arial","footerTemplate":"_PAGENUM_","chapterMark":"pagebreak","pageNumbers":true},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"VMware vSphere Integrated Containers 1.2 Documentation","gitbook":"3.x.x"},"file":{"path":"vic_vsphere_admin/vch_installer_examples.md","mtime":"2017-09-04T16:27:48.775Z","type":"markdown"},"gitbook":{"version":"3.2.2","time":"2017-09-04T16:30:02.346Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-expandable-chapters/expandable-chapters.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-edit-link/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>



<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Deploy a VCH with vSphere Integrated Containers Registry (Harbor) Â· VMware vSphere Integrated Containers 1.1 Documentation</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.2">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-expandable-chapters/expandable-chapters.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="install_vic_plugin.html" />
    
    
    <link rel="prev" href="set_up_ops_user.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">vSphere Administrators</li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="./">
            
                <a href="./">
            
                    
                    vSphere Integrated Containers for vSphere Administrators
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.1" data-path="introduction.html">
            
                <a href="introduction.html">
            
                    
                    Overview of vSphere Integrated Containers Engine for vSphere Administrators
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.1.1" data-path="interop.html">
            
                <a href="interop.html">
            
                    
                    Interoperability with Other VMware Software
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.1.2" data-path="networks.html">
            
                <a href="networks.html">
            
                    
                    Networks Used by vSphere Integrated Containers Engine
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.1.2" data-path="download_vic.html">
            
                <a href="download_vic.html">
            
                    
                    Download vSphere Integrated Containers
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.2.1" data-path="contents_of_vic_binaries.html">
            
                <a href="contents_of_vic_binaries.html">
            
                    
                    Contents of the vSphere Integrated Containers Engine Binaries
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.1.3" data-path="deploy_vch.html">
            
                <a href="deploy_vch.html">
            
                    
                    Using vic-machine to Deploy VCHs
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.3.1" data-path="vic_installation_prereqs.html">
            
                <a href="vic_installation_prereqs.html">
            
                    
                    Environment Prerequisites for VCH Deployment
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3.2" data-path="deploy_vch_esxi.html">
            
                <a href="deploy_vch_esxi.html">
            
                    
                    Deploy a VCH to an ESXi Host with No vCenter Server
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3.3" data-path="deploy_vch_vcenter.html">
            
                <a href="deploy_vch_vcenter.html">
            
                    
                    Deploy a VCH to a Basic vCenter Server Cluster
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3.4" data-path="verify_vch_deployment.html">
            
                <a href="verify_vch_deployment.html">
            
                    
                    Verify the Deployment of a VCH
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3.5" data-path="vch_installer_options.html">
            
                <a href="vch_installer_options.html">
            
                    
                    VCH Deployment Options
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3.6" data-path="vch_installer_examples.html">
            
                <a href="vch_installer_examples.html">
            
                    
                    Advanced Examples of Deploying a VCH
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3.7" data-path="set_up_ops_user.html">
            
                <a href="set_up_ops_user.html">
            
                    
                    Use Different User Accounts for VCH Deployment and Operation
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="2.1.3.8" data-path="deploy_vch_harbor.html">
            
                <a href="deploy_vch_harbor.html">
            
                    
                    Deploy a VCH with vSphere Integrated Containers Registry (Harbor)
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.1.4" data-path="install_vic_plugin.html">
            
                <a href="install_vic_plugin.html">
            
                    
                    Installing the vSphere Client Plug-ins
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.4.1" data-path="plugin_h5_vcsa.html">
            
                <a href="plugin_h5_vcsa.html">
            
                    
                    HTML5 on VCSA
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.4.2" data-path="plugin_h5_vc_web.html">
            
                <a href="plugin_h5_vc_web.html">
            
                    
                    HTML5 on Windows
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.4.3" data-path="plugin_vc_web.html">
            
                <a href="plugin_vc_web.html">
            
                    
                    Flex on Windows with a Web Server
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.4.4" data-path="plugin_vc_no_web.html">
            
                <a href="plugin_vc_no_web.html">
            
                    
                    Flex on Windows Without a Web Server
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.4.5" data-path="plugin_vcsa_web.html">
            
                <a href="plugin_vcsa_web.html">
            
                    
                    Flex on VCSA with a Web Server
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.4.6" data-path="plugin_vcsa_no_web.html">
            
                <a href="plugin_vcsa_no_web.html">
            
                    
                    Flex on VCSA Without a Web Server
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.4.7" data-path="plugin_verify_deployment.html">
            
                <a href="plugin_verify_deployment.html">
            
                    
                    Verify the Deployment of the Flex Plug-In
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.1.5" data-path="vch_admin.html">
            
                <a href="vch_admin.html">
            
                    
                    VCH Administration
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.5.1" data-path="access_h5_ui.html">
            
                <a href="access_h5_ui.html">
            
                    
                    Access the vSphere Integrated Containers View
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.5.2" data-path="vch_portlet_ui.html">
            
                <a href="vch_portlet_ui.html">
            
                    
                    Find VCH Information in the vSphere Web Client
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.5.3" data-path="container_portlet_ui.html">
            
                <a href="container_portlet_ui.html">
            
                    
                    Find Container Information in the vSphere Web Client
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.5.4" data-path="vic_machine_version.html">
            
                <a href="vic_machine_version.html">
            
                    
                    Obtain vic-machine Version Information
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.5.5" data-path="common_vic_options.html">
            
                <a href="common_vic_options.html">
            
                    
                    Common vic-machine Options
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.5.6" data-path="list_vch.html">
            
                <a href="list_vch.html">
            
                    
                    List VCHs and Obtain Their IDs
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.5.7" data-path="inspect_vch.html">
            
                <a href="inspect_vch.html">
            
                    
                    Obtain VCH Information
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.5.8" data-path="remove_vch.html">
            
                <a href="remove_vch.html">
            
                    
                    Delete a VCH
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.5.8.1" data-path="delete_vch_options.html">
            
                <a href="delete_vch_options.html">
            
                    
                    VCH Delete Options
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.1.5.9" data-path="access_vicadmin.html">
            
                <a href="access_vicadmin.html">
            
                    
                    Access the VCH Admin Portal
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.5.9.1" data-path="browser_login.html">
            
                <a href="browser_login.html">
            
                    
                    Browser-Based Certificate Login
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.5.9.2" data-path="cmdline_login.html">
            
                <a href="cmdline_login.html">
            
                    
                    Command Line Certificate Login
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.5.9.3" data-path="vicadmin_status_ref.html">
            
                <a href="vicadmin_status_ref.html">
            
                    
                    VCH Admin Status Reference
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.1.5.10" data-path="log_bundles.html">
            
                <a href="log_bundles.html">
            
                    
                    Access Log Bundles
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.5.11" data-path="debug_vch.html">
            
                <a href="debug_vch.html">
            
                    
                    Debugging the VCH
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.5.11.1" data-path="vch_shell_access.html">
            
                <a href="vch_shell_access.html">
            
                    
                    Enable Shell Access to the VCH Endpoint VM
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.5.11.2" data-path="vch_ssh_access.html">
            
                <a href="vch_ssh_access.html">
            
                    
                    Authorize SSH Access to the VCH Endpoint VM
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.5.11.3" data-path="debug_vch_options.html">
            
                <a href="debug_vch_options.html">
            
                    
                    VCH Debug Options
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.1.6" data-path="upgrading_vic.html">
            
                <a href="upgrading_vic.html">
            
                    
                    Upgrading vSphere Integrated Containers
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.6.1" data-path="upgrade_vch.html">
            
                <a href="upgrade_vch.html">
            
                    
                    Upgrade VCHs
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.6.1.1" data-path="upgrade_vch_options.html">
            
                <a href="upgrade_vch_options.html">
            
                    
                    VCH Upgrade Options
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.1.6.2" data-path="upgrade_h5_plugin.html">
            
                <a href="upgrade_h5_plugin.html">
            
                    
                    Upgrade the HTML5 Plug-In
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.1.7" data-path="troubleshoot_vic.html">
            
                <a href="troubleshoot_vic.html">
            
                    
                    Troubleshooting vSphere Integrated Containers
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.7.1" data-path="ts_vch_deployment_timeout.html">
            
                <a href="ts_vch_deployment_timeout.html">
            
                    
                    VCH Deployment Times Out
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.7.2" data-path="ts_thumbprint_error.html">
            
                <a href="ts_thumbprint_error.html">
            
                    
                    VCH Deployment Fails with a Certificate Verification Error
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.7.3" data-path="ts_cli_argument_error.html">
            
                <a href="ts_cli_argument_error.html">
            
                    
                    VCH Deployment Fails with Missing Common Name Error Even When TLS Options Are Specified Correctly
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.7.4" data-path="ts_firewall_error.html">
            
                <a href="ts_firewall_error.html">
            
                    
                    VCH Deployment Fails with Firewall Validation Error
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.7.5" data-path="ts_cname_mismatch.html">
            
                <a href="ts_cname_mismatch.html">
            
                    
                    VCH Deployment Fails with Certificate cname Mismatch
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.7.6" data-path="ts_docker_api_check_error.html">
            
                <a href="ts_docker_api_check_error.html">
            
                    
                    VCH Deployment Fails with Docker API Endpoint Check Failed Error
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.7.7" data-path="ts_datastore_access_error.html">
            
                <a href="ts_datastore_access_error.html">
            
                    
                    VCH Deployment Fails with Error About No Single Host Being Able to Access All Datastores
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.7.8" data-path="ts_ui_not_appearing.html">
            
                <a href="ts_ui_not_appearing.html">
            
                    
                    Plug-In Does Not Appear
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.7.9" data-path="ts_delete_inspect_error.html">
            
                <a href="ts_delete_inspect_error.html">
            
                    
                    Deleting or Inspecting a VCH Fails with an Error
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.7.10" data-path="ts_clock_skew.html">
            
                <a href="ts_clock_skew.html">
            
                    
                    Connections Fail with Certificate Errors when Using Full TLS Authentication with Trusted Certificates
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="security_reference.html">
            
                <a href="security_reference.html">
            
                    
                    vSphere Integrated Containers Security Reference
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Dev Ops Administrators</li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="../vic_dev_ops/">
            
                <a href="../vic_dev_ops/">
            
                    
                    vSphere Integrated Containers for Dev Ops Administrators
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1.1" data-path="../vic_dev_ops/overview_of_vic_devops.html">
            
                <a href="../vic_dev_ops/overview_of_vic_devops.html">
            
                    
                    Overview of vSphere Integrated Containers Engine For Dev Ops Administrators
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Container App Developers</li>
        
        
    
        <li class="chapter " data-level="4.1" data-path="../vic_app_dev/">
            
                <a href="../vic_app_dev/">
            
                    
                    Developing Container Applications with vSphere Integrated Containers
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1.1" data-path="../vic_app_dev/overview_of_vic_appdev.html">
            
                <a href="../vic_app_dev/overview_of_vic_appdev.html">
            
                    
                    Overview of vSphere Integrated Containers Engine For Container Application Developers
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.2" data-path="../vic_app_dev/container_operations.html">
            
                <a href="../vic_app_dev/container_operations.html">
            
                    
                    Supported Docker Commands
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1.2.1" data-path="../vic_app_dev/docker_compose_file_options.html">
            
                <a href="../vic_app_dev/docker_compose_file_options.html">
            
                    
                    Supported Docker Compose File Options
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.1.3" data-path="../vic_app_dev/container_limitations.html">
            
                <a href="../vic_app_dev/container_limitations.html">
            
                    
                    Use and Limitations of Containers in vSphere Integrated Containers Engine
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.4" data-path="../vic_app_dev/obtain_vch.html">
            
                <a href="../vic_app_dev/obtain_vch.html">
            
                    
                    Obtain a VCH
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.5" data-path="../vic_app_dev/using_volumes_with_vic.html">
            
                <a href="../vic_app_dev/using_volumes_with_vic.html">
            
                    
                    Using Volumes with vSphere Integrated Containers Engine
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.6" data-path="../vic_app_dev/using_registries_with_vic.html">
            
                <a href="../vic_app_dev/using_registries_with_vic.html">
            
                    
                    Using Private Registry Servers with vSphere Integrated Containers Engine
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.7" data-path="../vic_app_dev/using_vic_with_harbor.html">
            
                <a href="../vic_app_dev/using_vic_with_harbor.html">
            
                    
                    Using vSphere Integrated Containers Engine with vSphere Integrated Containers Registry (Harbor)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.8" data-path="../vic_app_dev/network_use_cases.html">
            
                <a href="../vic_app_dev/network_use_cases.html">
            
                    
                    Container Networking with vSphere Integrated Containers Engine
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.9" data-path="../vic_app_dev/creating_containerized_app_with_vic.html">
            
                <a href="../vic_app_dev/creating_containerized_app_with_vic.html">
            
                    
                    Creating a Containerized Application
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1.9.1" data-path="../vic_app_dev/constraints_using_vic.html">
            
                <a href="../vic_app_dev/constraints_using_vic.html">
            
                    
                    Constraints of Using vSphere Integrated Containers Engine to Build Applications
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.9.2" data-path="../vic_app_dev/build_app_with_vic.html">
            
                <a href="../vic_app_dev/build_app_with_vic.html">
            
                    
                    Example of Building an Application with vSphere Integrated Containers Engine
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.1.10" data-path="../vic_app_dev/ts_volume_store_error.html">
            
                <a href="../vic_app_dev/ts_volume_store_error.html">
            
                    
                    Default Volume Store Error
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Feedback</li>
        
        
    
        <li class="chapter " data-level="5.1" data-path="feedback.html">
            
                <a href="feedback.html">
            
                    
                    Send Doc Feedback
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Deploy a VCH with vSphere Integrated Containers Registry (Harbor)</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="deploy-a-vch-with-vsphere-integrated-containers-registry-harbor">Deploy a VCH with vSphere Integrated Containers Registry (Harbor)</h1>
<p>This example uses vSphere Integrated Containers Engine 1.1.0, Harbor 0.5.0, and Ubuntu on the user machine. Harbor requires 60GB or more free space on your datastore.</p>
<p>If no server certificate and private key are provided during installation, Harbor will create a self-generated CA (certificate authority) certificate, a server certificate, and a server private key.  The self-generated CA certificate will be available for download from the Harbor web client.</p>
<p>See the OVA installation guide for Harbor <a href="https://github.com/vmware/harbor/blob/master/docs/installation_guide_ova.md" target="_blank">Harbor docs</a>. Harbor requires both an IP address and FQDN (fully qualified domain name) for the server. A DHCP install method is available for debugging purposes, but it is not a recommended production deployment model.</p>
<p>This example assumes a Harbor instance was installed without a server certificate or a private key and the CA cert downloaded using the Harbor instructions. For Harbor to work with vSphere Integrated Containers Engine you need to update standard docker with the Harbor CA cert and deploy a new VCH with the CA cert.</p>
<h2 id="update-the-user-working-machines-standard-docker-with-the-harbor-ca-certificate">Update the User Working Machine&apos;s Standard Docker with the Harbor CA Certificate</h2>
<p>Update the machine with standard Docker so it recognizes the CA certificate. Docker can look for additional CA certificates outside of the operating system&apos;s CA bundle folder if the new CA certificates are in the correct location. See <a href="https://docs.docker.com/engine/security/certificates/" target="_blank">Verify repository client with certificates</a>.</p>
<p>Create the necessary folder, copy the CA cert file to the folder. Restart Docker, then verify that you can log onto the Harbor server.</p>
<p><strong>Note</strong> This example has Ubuntu-specific commands.</p>
<pre><code>user@Devbox:~/mycerts$ sudo su
[sudo] password for user: 
root@Devbox:/home/user/mycerts# mkdir -p /etc/docker/certs.d/&lt;Harbor FQDN&gt;
root@Devbox:/home/user/mycerts# mkdir -p /etc/docker/certs.d/&lt;Harbor IP&gt;
root@Devbox:/home/user/mycerts# cp ca.crt /etc/docker/certs.d/&lt;Harbor FQDN&gt;/
root@Devbox:/home/user/mycerts# cp ca.crt /etc/docker/certs.d/&lt;Harbor IP&gt;/
root@Devbox:/home/user/mycerts# exit
exit
user@Devbox:~/mycerts$ sudo systemctl daemon-reload
user@Devbox:~/mycerts$ sudo systemctl restart docker

user@Devbox:~$ docker logout &lt;Harbor FQDN&gt;
Remove login credentials for &lt;Harbor FQDN&gt;
user@Devbox:~$ docker logout &lt;Harbor IP&gt;
Remove login credentials for &lt;Harbor IP&gt;

user@Devbox:~$ docker login &lt;Harbor FQDN&gt;
Username: user
Password: 
Login Succeeded

user@Devbox:~$ docker login &lt;Harbor IP&gt;
Username: user
Password: 
Login Succeeded

user@Devbox:~$ docker logout &lt;Harbor FQDN&gt;
Remove login credentials for &lt;Harbor FQDN&gt;

user@Devbox:~$ docker logout &lt;Harbor IP&gt;
Remove login credentials for &lt;Harbor IP&gt;
</code></pre><p>This example creates folders for both FQDN and IP in the docker cert folder and copies the CA cert to both folders. You can then log into Harbor from Docker using both FQDN and IP address.</p>
<h2 id="install-a-vch-with-the-new-ca-certificate">Install a VCH with the New CA Certificate</h2>
<p>Deploy a VCH and specify the CA cert with <code>--registry-ca</code> parameter in vic-machine.  This parameter is a list, and you can easily add multiple CA certs by specifying multiple <code>--registry-ca</code> parameters.</p>
<p>For simplicity, this example installs a VCH with the <code>--no-tls</code> flag, so you do not need TLS from a docker CLI to the VCH. However, it does not imply that access to Harbor is performed without TLS.</p>
<pre>
./vic-machine-linux create 
--target=<vcenter_ip> 
--image-store=&quot;vsanDatastore&quot; 
--name=vic-docker 
--user=root 
--password=<vcenter_password> 
--compute-resource=&quot;/dc1/host/cluster1/Resources&quot; 
--bridge-network DPortGroup 
--force 
--no-tls 
--registry-ca=ca.crt

 WARN[2016-11-11T11:46:37-08:00] Configuring without TLS 
- all communications will be insecure
 ...

 INFO[2016-11-11T11:47:57-08:00] Installer completed successfully</vcenter_password></vcenter_ip></pre>            
                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="set_up_ops_user.html" class="navigation navigation-prev " aria-label="Previous page: Use Different User Accounts for VCH Deployment and Operation">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="install_vic_plugin.html" class="navigation navigation-next " aria-label="Next page: Installing the vSphere Client Plug-ins">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Deploy a VCH with vSphere Integrated Containers Registry (Harbor)","level":"2.1.3.8","depth":3,"next":{"title":"Installing the vSphere Client Plug-ins","level":"2.1.4","depth":2,"path":"vic_vsphere_admin/install_vic_plugin.md","ref":"vic_vsphere_admin/install_vic_plugin.md","articles":[{"title":"HTML5 on VCSA","level":"2.1.4.1","depth":3,"path":"vic_vsphere_admin/plugin_h5_vcsa.md","ref":"vic_vsphere_admin/plugin_h5_vcsa.md","articles":[]},{"title":"HTML5 on Windows","level":"2.1.4.2","depth":3,"path":"vic_vsphere_admin/plugin_h5_vc_web.md","ref":"vic_vsphere_admin/plugin_h5_vc_web.md","articles":[]},{"title":"Flex on Windows with a Web Server","level":"2.1.4.3","depth":3,"path":"vic_vsphere_admin/plugin_vc_web.md","ref":"vic_vsphere_admin/plugin_vc_web.md","articles":[]},{"title":"Flex on Windows Without a Web Server","level":"2.1.4.4","depth":3,"path":"vic_vsphere_admin/plugin_vc_no_web.md","ref":"vic_vsphere_admin/plugin_vc_no_web.md","articles":[]},{"title":"Flex on VCSA with a Web Server","level":"2.1.4.5","depth":3,"path":"vic_vsphere_admin/plugin_vcsa_web.md","ref":"vic_vsphere_admin/plugin_vcsa_web.md","articles":[]},{"title":"Flex on VCSA Without a Web Server","level":"2.1.4.6","depth":3,"path":"vic_vsphere_admin/plugin_vcsa_no_web.md","ref":"vic_vsphere_admin/plugin_vcsa_no_web.md","articles":[]},{"title":"Verify the Deployment of the Flex Plug-In","level":"2.1.4.7","depth":3,"path":"vic_vsphere_admin/plugin_verify_deployment.md","ref":"vic_vsphere_admin/plugin_verify_deployment.md","articles":[]}]},"previous":{"title":"Use Different User Accounts for VCH Deployment and Operation","level":"2.1.3.7","depth":3,"path":"vic_vsphere_admin/set_up_ops_user.md","ref":"vic_vsphere_admin/set_up_ops_user.md","articles":[]},"dir":"ltr"},"config":{"plugins":["expandable-chapters"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"expandable-chapters":{},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageBreaksBefore":"/","headerTemplate":"_TITLE_","paperSize":"a4","margin":{"right":62,"left":62,"top":56,"bottom":56},"fontSize":12,"fontFamily":"Arial","footerTemplate":"_PAGENUM_","chapterMark":"pagebreak","pageNumbers":true},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"VMware vSphere Integrated Containers 1.1 Documentation","gitbook":"3.x.x"},"file":{"path":"vic_vsphere_admin/deploy_vch_harbor.md","mtime":"2017-03-21T16:56:55.295Z","type":"markdown"},"gitbook":{"version":"3.2.2","time":"2017-03-21T16:59:42.570Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-expandable-chapters/expandable-chapters.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>


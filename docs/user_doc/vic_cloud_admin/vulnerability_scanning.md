## Vulnerability Scanning

vSphere Integrated Containers uses the open source project Clair to scan images for known vulnerabilities. Cloud administrators and DevOps administrators can set threshold values that restrict vulnerable images that exceed the threshold from being run on a per-project level. Once an image is uploaded into the registry, Clair checks the various layers of the image against known vulnerability databases and report issues to the administrators.

**Prerequisites**

You must provide access from your vSphere Integrated Containers instance to the following URLs so that Clair can sync its database.

|Item|Database URL|
|---|---|
|Ubuntu  |[Ubuntu database URL](https://github.com/coreos/clair/blob/6663bcef27b0a4221831a1ff7a05477247188b09/ext/vulnsrc/ubuntu/ubuntu.go#L40)|
|Red Hat Enterprise Linux    |[Rhel database URL](https://github.com/coreos/clair/blob/6663bcef27b0a4221831a1ff7a05477247188b09/ext/vulnsrc/rhel/rhel.go#L38)|
|Oracle  |[Oracle database URL](https://github.com/coreos/clair/blob/6663bcef27b0a4221831a1ff7a05477247188b09/ext/vulnsrc/oracle/oracle.go#L39)|
|Debian  |[Debian database URL](https://github.com/coreos/clair/blob/6663bcef27b0a4221831a1ff7a05477247188b09/ext/vulnsrc/debian/debian.go#L37)|
|Alpine  |[Alpine database URL](https://github.com/coreos/clair/blob/6663bcef27b0a4221831a1ff7a05477247188b09/ext/vulnsrc/alpine/alpine.go#L37)|
|National Vulnerability Database|[NIST NVD database URL](https://github.com/coreos/clair/blob/release-2.0/ext/vulnmdsrc/nvd/nvd.go#L41)|

### Configure Scheduled Vulnerability Scan on All Images 

**Procedure**

1. Go to http://<i>vic_appliance_address</i>, click the link to **Go to the vSphere Integrated Containers Management Portal**, and enter the vCenter Server Single Sign-On credentials.
7. Select **Administration** > **Configuration** and under **Vulnerability Scanning**, verify that the database updates that it was recently updated.
8. Optionally, change the default settings for the scheduled daily vulnerability scanning and click **Save**.

	You can schedule a full scan for all images once a day or disable the automated full scan.

1. (Optional) Click **Scan Now** to manually start a full scan for all images.

	You can start a manual scan once in two hours as the procedure is resource intensive.

### Configure Vulnerability Scanning on a Per-Project Level

Cloud administrators and DevOps administrators can set threshold values that restrict vulnerable images that exceed the threshold from being run. An automated scan on new images that are pushed to the project registry is also available.

**Procedure**

1. In the Management Portal, navigate to **Administration** > **Projects** > **Your_project** > **Configuration**.
2. To prevent vulnerable images from your project repository to run, select the **Prevent vulnerable images from running** check box.
3. (Optional) Change the severity level of vulnerabilities found that prevents an image to run.
	
	Images cannot be run if their level equals the currently selected level or higher.

1.  To activate an immediate vulnerability scan on new images that are pushed to the project registry, select the **Automatically scan images on push** check box.

### Perform a Vulnerability Scan on a Single Image

Cloud administrators and DevOps administrators can perform a manual scan on a single image.

**Procedure**

1. In the Mangement Portal, navigate to **Administration** > **Projects** > **Your_project** > **Repositories**.
2. Expand an image repository.
3. Click the three dots next to an image and click **Scan**.